## M5

### コンペ概要

ウォルマート主催の時系列予測タスクのコンペ。




ウォルマート
  アメリカ合衆国アーカンソー州に本部を置く世界最大のスーパーマーケットチェーンであり、売上額で世界最大の企業である
  
  https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwjGxM6Lk7DpAhVR62EKHS0eBUcQFjAAegQIBBAB&url=https%3A%2F%2Fja.wikipedia.org%2Fwiki%2F%25E3%2582%25A6%25E3%2582%25A9%25E3%2583%25AB%25E3%2583%259E%25E3%2583%25BC%25E3%2583%2588&usg=AOvVaw2ALh2Jffnzlmj5M56Uy5wK


### タスク
---------
学習期間後の28日間の日次の売上高を予測する

今回のタスクの特徴としてゼロを多く含む散発的な売上がある商品が含まれている。
下記に示す指標の特性上、レアイベントをどう扱うかも大事な要素と成る。



### 評価指標

Root Mean Squared Scaled Error (RMSSE)

まず42840の各商品の売上額実績と売上額予測について、下記指標を計算する。

```math
  RMSSE = 
  \sqrt{
  \frac{1}{h} 
  \frac{\sum_{t=n+1}^{n+h}(Y_t-\hat Y_t)^2}
      {\frac{1}{n-1}\sum_{t=2}^{n}(Y_t-Y_{t-1})^2}
  }
```

ここで

  ``$` n: `$`` トレーニングのレコード数 <br>
  ``$` h: `$`` 予測期間

式の分母は商品が販売された後から計算され始めることに注意。
評価対象の期間のうち、初めて商品に需要が生じて以降が指標の計算期間となる。




次にそれぞれの系列に重みをかけて Weighted RMSSEを計算する

この重み ``$` w_i `$`` は**学習データの** 期間の最後の28日間のデータを基に決定される（＝予測期間と同一）


```math
  W RMSSE = \sum_i^{42480} w_i * RMSSE_i
```
重みは各系列における売上の総和で計算される。
集計期間内で商品単価が価格が変わることも考えらるが、単価は期間の代表値でなく、各日に売れた商品に紐づく値を利用する。

集計対象の商品種類数を ``$` K `$`` 、
商品 ``$` i `$`` の最終28日間の商品の売上額総和を ``$` Sales_i `$`` 
とすると下記式で計算されることになる。具体例は
```math
  w_i = \frac{1}{K} \frac{Sales_i}{\sum_i^K Sales_i}
```




### データ概略

#### 期間
  - 学習データ
    - 2011-01-29 - 2016-06-19
  
  - テストデータ
    - この後28日間



アメリカの3つの洲に存在する店舗が対象

- カリフォルニア
- テキサス
- ウィスコンシン

説明変数のタイプは下記が主に含まれている

- アイテムレベル
- 部門
- 製品カテゴリ
- 店舗の詳細
- 価格
- プロモーション
- 曜日
- 特別イベント


